---
layout: post
title: jstack 应用
category: tech
---

某日某机器负载突然飙高，记录一下排查步骤

1. 检查机器负载情况

```
vmstat 1
```
或者
```
top
```
vmstat 更能客观的显示机器整体当前的负载情况
top 则能够帮助定位到让CPU飙高的进程

2. 找到当前让CPU飙升的进程，查看指定进程的负载情况
```
top -Hp 12345
```

3. jstack
```
printf "%x\n" 12345
jstack 12345 | grep 3039
```
jstack中的进程号使用的是十六进制（12345->3039）

日志中就可以用来定位死循环，死锁，线程阻塞等问题了

最后发现的问题是jstack日志正常，服务有一台挂了，导致负载升高
